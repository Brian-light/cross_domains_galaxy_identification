Training mode: Adversarial + fisher + EM
Training model...
Epoch [1/30]	Time: 8.24 seconds	Total Loss: 1.835	Classifier Loss: 0.685	Transfer Loss: 1.11173	Fisher Loss: 0.039	EM Loss: 0.000	Source Domain Accuracy: 55.79%    Target Domain Accuracy: 55.73%
Epoch [2/30]	Time: 5.75 seconds	Total Loss: 1.372	Classifier Loss: 0.674	Transfer Loss: 0.65870	Fisher Loss: 0.039	EM Loss: 0.000	Source Domain Accuracy: 56.77%    Target Domain Accuracy: 57.94%
Epoch [3/30]	Time: 6.80 seconds	Total Loss: 1.332	Classifier Loss: 0.665	Transfer Loss: 0.62879	Fisher Loss: 0.039	EM Loss: 0.000	Source Domain Accuracy: 58.79%    Target Domain Accuracy: 59.05%
Epoch [4/30]	Time: 7.09 seconds	Total Loss: 1.349	Classifier Loss: 0.661	Transfer Loss: 0.64949	Fisher Loss: 0.039	EM Loss: 0.000	Source Domain Accuracy: 60.42%    Target Domain Accuracy: 61.20%
Epoch [5/30]	Time: 6.04 seconds	Total Loss: 1.352	Classifier Loss: 0.651	Transfer Loss: 0.66175	Fisher Loss: 0.039	EM Loss: 0.000	Source Domain Accuracy: 63.87%    Target Domain Accuracy: 64.45%
Epoch [6/30]	Time: 7.86 seconds	Total Loss: 1.357	Classifier Loss: 0.648	Transfer Loss: 0.67049	Fisher Loss: 0.038	EM Loss: 0.000	Source Domain Accuracy: 62.70%    Target Domain Accuracy: 62.43%
Epoch [7/30]	Time: 6.51 seconds	Total Loss: 1.362	Classifier Loss: 0.641	Transfer Loss: 0.68205	Fisher Loss: 0.039	EM Loss: 0.000	Source Domain Accuracy: 64.19%    Target Domain Accuracy: 63.80%
Epoch [8/30]	Time: 5.82 seconds	Total Loss: 1.358	Classifier Loss: 0.636	Transfer Loss: 0.68272	Fisher Loss: 0.039	EM Loss: 0.000	Source Domain Accuracy: 62.70%    Target Domain Accuracy: 63.28%
Epoch [9/30]	Time: 5.81 seconds	Total Loss: 1.352	Classifier Loss: 0.630	Transfer Loss: 0.68385	Fisher Loss: 0.038	EM Loss: 0.000	Source Domain Accuracy: 62.17%    Target Domain Accuracy: 62.89%
Epoch [10/30]	Time: 5.85 seconds	Total Loss: 1.346	Classifier Loss: 0.624	Transfer Loss: 0.68364	Fisher Loss: 0.038	EM Loss: 0.000	Source Domain Accuracy: 63.67%    Target Domain Accuracy: 64.65%
Epoch [11/30]	Time: 6.14 seconds	Total Loss: 1.344	Classifier Loss: 0.620	Transfer Loss: 0.68563	Fisher Loss: 0.038	EM Loss: 0.000	Source Domain Accuracy: 65.43%    Target Domain Accuracy: 65.69%
Epoch [12/30]	Time: 5.78 seconds	Total Loss: 1.339	Classifier Loss: 0.615	Transfer Loss: 0.68615	Fisher Loss: 0.038	EM Loss: 0.000	Source Domain Accuracy: 65.76%    Target Domain Accuracy: 65.23%
Epoch [13/30]	Time: 5.97 seconds	Total Loss: 1.336	Classifier Loss: 0.610	Transfer Loss: 0.68814	Fisher Loss: 0.038	EM Loss: 0.000	Source Domain Accuracy: 61.59%    Target Domain Accuracy: 62.50%
Epoch [14/30]	Time: 5.72 seconds	Total Loss: 1.337	Classifier Loss: 0.610	Transfer Loss: 0.68918	Fisher Loss: 0.038	EM Loss: 0.000	Source Domain Accuracy: 66.99%    Target Domain Accuracy: 67.25%
Epoch [15/30]	Time: 5.77 seconds	Total Loss: 1.327	Classifier Loss: 0.602	Transfer Loss: 0.68817	Fisher Loss: 0.038	EM Loss: 0.000	Source Domain Accuracy: 67.32%    Target Domain Accuracy: 67.58%
Epoch [16/30]	Time: 5.82 seconds	Total Loss: 1.322	Classifier Loss: 0.597	Transfer Loss: 0.68789	Fisher Loss: 0.037	EM Loss: 0.000	Source Domain Accuracy: 67.77%    Target Domain Accuracy: 68.36%
Epoch [17/30]	Time: 5.75 seconds	Total Loss: 1.313	Classifier Loss: 0.588	Transfer Loss: 0.68781	Fisher Loss: 0.037	EM Loss: 0.000	Source Domain Accuracy: 65.62%    Target Domain Accuracy: 66.60%
Epoch [18/30]	Time: 5.76 seconds	Total Loss: 1.309	Classifier Loss: 0.586	Transfer Loss: 0.68634	Fisher Loss: 0.037	EM Loss: 0.000	Source Domain Accuracy: 67.77%    Target Domain Accuracy: 67.12%
Epoch [19/30]	Time: 5.79 seconds	Total Loss: 1.300	Classifier Loss: 0.578	Transfer Loss: 0.68564	Fisher Loss: 0.037	EM Loss: 0.000	Source Domain Accuracy: 70.38%    Target Domain Accuracy: 69.99%
Epoch [20/30]	Time: 5.78 seconds	Total Loss: 1.291	Classifier Loss: 0.570	Transfer Loss: 0.68411	Fisher Loss: 0.036	EM Loss: 0.000	Source Domain Accuracy: 68.03%    Target Domain Accuracy: 68.68%
Epoch [21/30]	Time: 5.79 seconds	Total Loss: 1.283	Classifier Loss: 0.562	Transfer Loss: 0.68410	Fisher Loss: 0.037	EM Loss: 0.000	Source Domain Accuracy: 70.38%    Target Domain Accuracy: 69.53%
Epoch [22/30]	Time: 5.77 seconds	Total Loss: 1.270	Classifier Loss: 0.553	Transfer Loss: 0.68076	Fisher Loss: 0.036	EM Loss: 0.000	Source Domain Accuracy: 71.94%    Target Domain Accuracy: 71.16%
Epoch [23/30]	Time: 5.82 seconds	Total Loss: 1.267	Classifier Loss: 0.550	Transfer Loss: 0.68098	Fisher Loss: 0.036	EM Loss: 0.000	Source Domain Accuracy: 71.03%    Target Domain Accuracy: 70.31%
Epoch [24/30]	Time: 5.81 seconds	Total Loss: 1.256	Classifier Loss: 0.535	Transfer Loss: 0.68434	Fisher Loss: 0.036	EM Loss: 0.000	Source Domain Accuracy: 70.70%    Target Domain Accuracy: 71.16%
Epoch [25/30]	Time: 5.74 seconds	Total Loss: 1.256	Classifier Loss: 0.534	Transfer Loss: 0.68601	Fisher Loss: 0.036	EM Loss: 0.000	Source Domain Accuracy: 72.59%    Target Domain Accuracy: 70.90%
Epoch [26/30]	Time: 5.79 seconds	Total Loss: 1.247	Classifier Loss: 0.522	Transfer Loss: 0.68868	Fisher Loss: 0.036	EM Loss: 0.000	Source Domain Accuracy: 72.79%    Target Domain Accuracy: 71.61%
Epoch [27/30]	Time: 5.75 seconds	Total Loss: 1.241	Classifier Loss: 0.518	Transfer Loss: 0.68763	Fisher Loss: 0.036	EM Loss: 0.000	Source Domain Accuracy: 74.02%    Target Domain Accuracy: 72.20%
Epoch [28/30]	Time: 5.81 seconds	Total Loss: 1.240	Classifier Loss: 0.515	Transfer Loss: 0.68853	Fisher Loss: 0.036	EM Loss: 0.000	Source Domain Accuracy: 73.96%    Target Domain Accuracy: 73.24%
Epoch [29/30]	Time: 5.78 seconds	Total Loss: 1.234	Classifier Loss: 0.510	Transfer Loss: 0.68811	Fisher Loss: 0.036	EM Loss: 0.000	Source Domain Accuracy: 69.86%    Target Domain Accuracy: 70.96%
Epoch [30/30]	Time: 5.80 seconds	Total Loss: 1.225	Classifier Loss: 0.504	Transfer Loss: 0.68621	Fisher Loss: 0.036	EM Loss: 0.000	Source Domain Accuracy: 74.41%    Target Domain Accuracy: 73.31%
Training complete
Saved model in: /content/PHYS449GroupProject/results/adversarial_fisher_sim/DeepMerge_net.pt
-------------------------------------------------
Validating model...
Source domain results:
Accuracy: 73.31%    Balanced Accuracy: 73.97%    Precision: 80.98    Recall: 0.67    F1: 0.73    Brier_score: 0.27    AU: 80.99%
Target domain results:
Accuracy: 71.35%    Balanced Accuracy: 71.74%    Precision: 77.17    Recall: 0.68    F1: 0.72    Brier_score: 0.29    AU: 78.84%
